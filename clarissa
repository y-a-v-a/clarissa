#!/usr/bin/env node

const clarissa = require('./index');
const arguments = process.argv;

if (arguments.length === 3 && arguments[2] === 'list') {
  const allCiphers = clarissa.getCiphers();
  console.log(`Available ciphers:

${allCiphers.join('\n')}
`);
  process.exit();
}

if (arguments.length <= 3 || arguments[2] && arguments[2] === '--help') {
  console.log(`Too few arguments.

Please use this way:
$ clarissa <cipher> <plaintext>     Encrypt <plaintext> with given <cipher>
$ clarissa list                     List available ciphers

Example:
$ clarissa Caesar "this is caesar ciphered"
`);

  process.exit(1);
}

const cipher = arguments[2];
const plaintext = arguments[3];

try {
  const cipherInstance = clarissa.createCipher(cipher);
  const result = cipherInstance.encrypt(plaintext);

  console.log(result);
} catch (exception) {
  console.log(exception.message);
}
